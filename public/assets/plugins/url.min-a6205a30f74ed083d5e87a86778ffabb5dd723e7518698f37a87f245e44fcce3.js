!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,n){return void 0===n&&(n="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(n)}:e(window.jQuery)}(function(e){e.FE.URLRegEx="(^| |\\u00A0)("+e.FE.LinkRegEx+"|([a-z0-9+-_.]{1,}@[a-z0-9+-_.]{1,}\\.[a-z0-9+-_]{1,}))$",e.FE.PLUGINS.url=function(t){function n(e,n,r){for(var i="";r.length&&"."==r[r.length-1];)i+=".",r=r.substring(0,r.length-1);var o=r;if(t.opts.linkConvertEmailAddress)t.helpers.isEmail(o)&&!/^mailto:.*/i.test(o)&&(o="mailto:"+o);else if(t.helpers.isEmail(o))return n+r;return/^((http|https|ftp|ftps|mailto|tel|sms|notes|data)\:)/i.test(o)||(o="//"+o),(n||"")+"<a"+(t.opts.linkAlwaysBlank?' target="_blank"':"")+(u?' rel="'+u+'"':"")+' data-fr-linked="true" href="'+o+'">'+r.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/&amp;/g,"&").replace(/&/g,"&amp;")+"</a>"+i}function r(){return new RegExp(e.FE.URLRegEx,"gi")}function i(e){return t.opts.linkAlwaysNoFollow&&(u="nofollow"),t.opts.linkAlwaysBlank&&(u?u+=" noopener noreferrer":u="noopener noreferrer"),e.replace(r(),n)}function o(e){return!!e&&("A"===e.tagName||!(!e.parentNode||e.parentNode==t.el)&&o(e.parentNode))}function l(e){var t=e.split(" ");return t[t.length-1]}function a(){var n=t.selection.ranges(0).startContainer;if(!n||n.nodeType!==Node.TEXT_NODE)return!1;if(o(n))return!1;if(r().test(l(n.textContent))){e(n).before(i(n.textContent));var a=e(n.parentNode).find("a[data-fr-linked]");a.removeAttr("data-fr-linked"),n.parentNode.removeChild(n),t.events.trigger("url.linked",[a.get(0)])}else if(n.textContent.split(" ").length<=2&&n.previousSibling&&"A"===n.previousSibling.tagName){var s=n.previousSibling.innerText+n.textContent;r().test(l(s))&&(e(n.previousSibling).replaceWith(i(s)),n.parentNode.removeChild(n))}}function s(){t.events.on("keypress",function(n){var r=n.which;!t.selection.isCollapsed()||r!=e.FE.KEYCODE.ENTER&&r!=e.FE.KEYCODE.SPACE&&"."!=n.key&&")"!=n.key&&"("!=n.key||a()},!0)}var u=null;return{_init:s}}});